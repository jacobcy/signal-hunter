# AI团队架构设计
## Signal Hunter 项目 - AI角色定义与协作体系

---

## 1. 组织架构

```
老板（战略层）
    ↓ 指派目标 + 接收统一报告
木木（AI项目经理 - 任务调度中心 + 报告汇总）
    ↓ 拆分任务、派遣、监控、整合、报告
├─ 产品经理（PM）
├─ 程序员（Dev）
├─ 测试工程师（QA）
├─ 运营经理（Ops）
├─ 数据分析师（Analyst）
├─ 编辑（Editor）
├─ 网络研究员（Web Researcher）🆕 外部情报
└─ HR（角色管理 + Skill配置）
    ↓ 定义/优化/配置
角色人设 + 技能矩阵 + 协作规范 + Skills安装
```

---

## 2. 角色定义

### 2.1 木木 - AI项目经理（Task Orchestrator）
**核心职责**：
- 接收老板战略目标，转化为可执行任务
- 任务拆分与并行规划
- AI小队派遣与监控
- 结果整合与汇报
- 团队效能优化

**专属Skills**：
- `session_spawn` - 创建/管理AI小队
- `sessions_list/monitor` - 监控任务进度
- `cron` - 定时任务调度
- `memory_search/get` - 历史上下文检索
- `exec` - 系统命令执行

**工作模式**：
- 不下场写代码，只orchestrate
- 高密度汇报：做了什么|发现什么|还差什么
- 六条原则：侦察先行、最大化并行、快速失败补救

---

### 2.2 产品经理（PM）- Product Manager Agent
**核心职责**：
- 需求分析与PRD撰写
- 功能优先级排序
- 用户体验设计
- 竞品分析与市场调研

**专属Skills**：
- `web_search` - 竞品调研、市场趋势
- `web_fetch` - 深度内容分析
- `write` - PRD、需求文档撰写
- `read` - 代码审查、文档分析
- `image` - UI/UX设计分析

**任务模板**：
```
【角色】产品经理 - [功能模块]
【目标】完成[功能]的PRD与需求分析
【输入】老板需求描述/竞品参考
【输出】
1. PRD文档 (docs/PRD_[feature].md)
2. 功能优先级矩阵
3. 竞品分析报告
4. 技术可行性评估
```

**典型任务**：
- 新功能需求分析 → PRD
- 竞品功能对比 → 差异化建议
- 用户反馈整理 → 优化清单

---

### 2.3 程序员（Dev）- Developer Agent
**核心职责**：
- 代码实现与功能开发
- Bug修复与技术债务清理
- 单元测试与集成测试
- 代码重构与性能优化

**专属Skills**：
- `read/edit/write` - 代码CRUD
- `exec` - 运行测试、类型检查
- `sessions_spawn` - 复杂任务可再拆子任务
- `memory_search` - 技术方案检索

**任务模板**：
```
【角色】程序员 - [模块]
【目标】实现/修复[具体功能]
【技术栈】Python 3.14, aiosqlite, pydantic
【输入】PRD/技术设计/bug报告
【输出】
1. 实现代码
2. 单元测试
3. 类型检查通过 (mypy)
4. 代码风格检查通过 (ruff)
【约束】
- 每完成子任务commit
- 保持测试覆盖率
- 遵循现有架构模式
```

**典型任务**：
- 实现新API端点
- 修复数据库连接问题
- 重构processor模块
- 添加测试覆盖

---

### 2.4 运营经理（Ops）- Operations Agent
**核心职责**：
- 部署与发布管理
- 系统监控与告警
- 日常巡检与健康检查
- 日志分析与故障排查

**专属Skills**：
- `exec` - 部署脚本、系统命令
- `cron` - 定时巡检任务
- `message` - 告警通知(Telegram)
- `read` - 日志分析
- `process` - 后台进程管理

**任务模板**：
```
【角色】运营经理 - [环境]
【目标】部署/监控/维护[服务]
【环境】本地/Mac mini/未来云服务器
【输出】
1. 部署状态确认
2. 健康检查报告
3. 监控告警配置
4. 故障排查记录
【检查项】
- Bot进程存活
- 数据库连接正常
- 日志无异常
- 定时任务运行
```

**典型任务**：
- 日常健康检查 → 报告
- Bot进程监控 → 自动重启
- 部署新版本 → 验证
- 告警响应 → 故障处理

---

### 2.5 测试工程师（QA）- Quality Assurance Agent
**核心职责**：
- 测试策略设计与测试计划制定
- 单元测试、集成测试、E2E测试编写
- 自动化测试框架搭建与维护
- Bug跟踪与质量报告
- 代码覆盖率监控

**专属Skills**：
- `exec` - 运行测试套件 (pytest, coverage)
- `read` - 代码审查、测试用例分析
- `write` - 测试代码、测试报告
- `edit` - 修复测试代码
- `memory_search` - 历史bug模式分析

**任务模板**：
```
【角色】测试工程师 - [模块]
【目标】为[功能]设计并实现完整测试覆盖
【测试范围】单元/集成/E2E
【输出】
1. 测试计划文档
2. 测试代码 (test_*.py)
3. 覆盖率报告 (≥80%)
4. Bug清单（如发现）
5. 质量评估报告
【检查项】
- 边界条件覆盖
- 异常路径测试
- 并发/异步测试
- 类型检查通过
```

**典型任务**：
- 为新功能编写测试套件
- 提升代码覆盖率至80%+
- 修复flaky tests
- 搭建自动化测试流水线

**与Dev协作**：
- Dev写功能代码 → QA写对应测试
- QA发现bug → Dev修复 → QA验证
- 并行执行，缩短交付周期

---

### 2.6 数据分析师（Analyst）- Data Analyst Agent
**核心职责**：
- 信号数据统计分析
- 趋势识别与预测
- 可视化报告生成
- 数据质量监控

**专属Skills**：
- `exec` - SQL查询、数据分析脚本
- `read` - 数据库、CSV文件
- `write` - 分析报告、图表数据
- `image` - 生成可视化图表
- `canvas` - 数据看板呈现

**任务模板**：
```
【角色】数据分析师
【目标】分析[数据范围] → [洞察]
【数据源】SQLite数据库、信号日志
【输出】
1. 数据统计摘要
2. 趋势分析报告
3. 可视化图表
4. 异常检测报告
【分析维度】
- 信号频率、准确率
- 源质量评分
- 情绪趋势变化
- 预测准确率
```

**典型任务**：
- 周度信号统计 → 趋势报告
- 源准确率分析 → 质量评级
- 情绪时间序列 → 预测模型
- 异常信号检测 → 告警

---

### 2.6 编辑（Editor）- Technical Writer Agent
**核心职责**：
- 技术文档撰写与维护
- README与使用指南
- API文档自动生成
- 博客/推文内容创作

**专属Skills**：
- `write` - Markdown文档
- `read` - 代码注释、现有文档
- `web_fetch` - 参考最佳实践
- `image` - 文档配图分析

**任务模板**：
```
【角色】技术编辑
【目标】撰写/更新[文档类型]
【读者】开发者/用户/老板
【输出】
1. README.md / 使用指南
2. API文档
3. 架构说明文档
4. 变更日志 (CHANGELOG)
【风格】
- 简洁清晰
- 代码示例完整
- 中英双语支持
```

**典型任务**：
- 项目README重构
- API文档自动生成
- 新版本发布公告
- 技术博客撰写

---

### 2.7 HR（人力资源）- Role Definition Agent
**核心职责**：
- AI角色人设设计与优化
- 技能矩阵定义与更新
- 角色协作规范制定
- 团队效能评估与改进建议
- 新角色调研与引入评估

**专属Skills**：
- `skill-manager` - **核心：为团队成员配置项目所需的OpenClaw skills**
- `web_search` - 行业最佳实践、AI团队模式
- `write` - 角色定义文档、协作规范
- `read` - 现有角色定义、执行反馈
- `memory_search` - 历史协作模式分析
- `edit` - 优化角色定义

**任务模板**：
```
【角色】HR - AI团队架构师
【目标】设计/优化[角色]的人设与技能
【输入】
- 现有角色执行反馈
- 行业最佳实践
- 项目需求变化
【输出】
1. 角色人设文档（性格、工作风格、语气）
2. 技能矩阵定义（可用/禁用tools）
3. 协作规范（输入输出标准、交接流程）
4. 效能评估报告
5. 改进建议
【设计原则】
- 角色边界清晰
- 技能与职责匹配
- 协作流程顺畅
- 可扩展性
```

**典型任务**：
- 设计新角色人设（如UI设计师、安全工程师）
- 优化现有角色技能矩阵
- 制定跨角色协作SOP
- 评估引入新角色的ROI
- 分析团队瓶颈并提出架构调整建议

**与木木协作**：
- HR设计角色 → 木木按角色派遣任务
- 木木反馈执行问题 → HR优化角色定义
- HR监控团队健康度 → 向老板汇报组织建议

---

### 2.8 网络研究员（Web Researcher）- External Intelligence Agent
**核心职责**：
- 外部信息获取与网络浏览
- 社交媒体监控（Twitter/X, LinkedIn, Telegram）
- 竞品动态追踪与市场调研
- 新闻RSS监控与聚合
- 外部API数据获取
- 为团队提供实时外部情报

**专属Skills**：
- `bird` - **X/Twitter CLI：读取、搜索、发布推文**
- `himalaya` - **邮件管理：IMAP/SMTP邮件收发**
- `linkedin-cli` - **LinkedIn自动化：搜索档案、发送消息**
- `telegram-usage` - **Telegram监控：会话统计和通知**
- `brave-search` - **网页搜索：Brave Search API**
- `kagi-search` - **Kagi搜索：高质量搜索结果**
- `tavily` - **AI优化搜索：为AI设计的搜索引擎**
- `exa` - **神经搜索：语义理解和代码搜索**
- `parallel` - **高精度搜索：深度网页研究**
- `miniflux-news` - **RSS聚合：新闻源监控**

**任务模板**：
```
【角色】网络研究员 - 外部情报收集
【目标】监控[目标]的最新动态并提供情报摘要
【输入】
- 监控目标（Twitter账号、竞品公司、关键词）
- 时间范围（实时/每日/每周）
- 输出格式（摘要/详细报告/原始数据）
【输出】
1. 情报摘要报告（关键点、趋势、异常）
2. 原始数据存档（推文、文章、邮件）
3. 可视化时间线（如有需要）
4. 预警通知（重要动态即时上报）
【工作流】
1. 使用bird监控Twitter/X动态
2. 使用himalaya检查相关邮件
3. 使用brave-search/kagi-search进行深度搜索
4. 使用miniflux-news聚合RSS源
5. 整理成结构化报告提交给PM
```

**典型任务**：
- 监控@elonmusk推文 → 情绪分析报告
- 追踪竞品产品发布 → 竞品动态周报
- 搜索行业新闻 → 每日情报简报
- 监控Telegram频道 → 加密市场信号
- 检查LinkedIn动态 → 人才流动分析

**与团队协作**：
- **PM（木木）**：派遣研究任务，定义情报需求
- **Analyst**：接收原始数据进行深度分析
- **Editor**：将情报转化为发布内容
- **PM**：整合情报到决策支持

**关键价值**：
- **实时性**：第一时间获取外部动态
- **全面性**：覆盖社交媒体、新闻、邮件多渠道
- **自动化**：定时监控，减少人工重复劳动
- **情报驱动**：为团队决策提供外部数据支持

---

## 3. 协作流程

### 3.1 标准工作流程

```
老板需求
    ↓
[木木侦察] → 派出PM分析
    ↓
[PM产出] → PRD + 技术方案
    ↓
[木木规划] → 拆分任务队列
    ↓
并行派遣:
  ├─ Dev: 代码实现
  ├─ Analyst: 数据准备
  └─ Editor: 文档准备
    ↓
[木木整合] → 合并 + 验证
    ↓
[Ops部署] → 上线 + 监控
    ↓
高密度汇报给老板
```

### 3.2 任务分派策略

| 任务类型 | 主责角色 | 协作角色 | 交付物 |
|---------|---------|---------|--------|
| 新功能开发 | Dev | PM(需求)、Editor(文档) | 代码+测试+文档 |
| Bug修复 | Dev | Ops(验证)、Analyst(根因) | 修复+报告 |
| 数据洞察 | Analyst | PM(业务解读) | 分析报告 |
| 部署运维 | Ops | Dev(支持) | 部署确认 |
| 内容发布 | Editor | PM(策略) | 发布内容 |

---

## 4. 角色Skill矩阵

### 4.1 核心工具矩阵

| Skill | 木木 | PM | Dev | QA | Ops | Analyst | Editor | WebR | HR |
|-------|------|-----|-----|-----|-----|---------|--------|------|-----|
| session_spawn | ✅ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| web_search | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| read/edit/write | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| exec | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ❌ |
| cron | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ |
| message | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ | ❌ |
| image | ❌ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ | ❌ | ❌ |
| canvas | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ |

### 4.2 新增专用Skills矩阵

| Skill | Dev | Ops | Analyst | WebR | HR | 说明 |
|-------|-----|-----|---------|------|-----|------|
| conventional-commits | ✅ | ❌ | ❌ | ❌ | ❌ | 提交规范 |
| github-pr | ✅ | ❌ | ❌ | ❌ | ❌ | PR管理 |
| coding-agent | ✅ | ❌ | ❌ | ❌ | ❌ | 多IDE支持 |
| linux-service-triage | ❌ | ✅ | ❌ | ❌ | ❌ | 服务诊断 |
| deploy-agent | ❌ | ✅ | ❌ | ❌ | ❌ | 部署自动化 |
| browser | ❌ | ❌ | ✅ | ✅ | ❌ | 浏览器控制 |
| brave-search | ❌ | ❌ | ✅ | ✅ | ❌ | 网页搜索 |
| kagi-search | ❌ | ❌ | ❌ | ✅ | ❌ | Kagi搜索 |
| tavily | ❌ | ❌ | ❌ | ✅ | ❌ | AI搜索 |
| exa | ❌ | ❌ | ✅ | ✅ | ❌ | 神经搜索 |
| **bird** | ❌ | ❌ | ❌ | ✅ | ❌ | **X/Twitter** |
| **himalaya** | ❌ | ❌ | ❌ | ✅ | ❌ | **邮件管理** |
| **linkedin-cli** | ❌ | ❌ | ❌ | ✅ | ❌ | **LinkedIn** |
| frontend-design | ❌ | ❌ | ❌ | ❌ | ❌ | Editor专用 |
| ui-audit | ❌ | ❌ | ❌ | ❌ | ❌ | Editor专用 |
| agentlens | ❌ | ❌ | ❌ | ❌ | ✅ | HR专用 |
| skill-manager | ❌ | ❌ | ❌ | ❌ | ✅ | HR专用 |

**说明**：
- **WebR** = Web Researcher（网络研究员）
- **bird/himalaya/linkedin-cli** 为网络研究员核心技能
- 全局安装，所有角色可按需调用

### 4.3 Skill功能说明

| Skill | 功能 | 典型使用者 |
|-------|------|-----------|
| `session_spawn` | 创建子任务session | 木木、Dev |
| `web_search` | 网络调研 | PM、Analyst、WebR、HR |
| `bird` | X/Twitter监控 | **WebR核心** |
| `himalaya` | IMAP/SMTP邮件 | **WebR核心** |
| `linkedin-cli` | LinkedIn自动化 | **WebR核心** |
| `brave-search` | 网页搜索 | Analyst、WebR |
| `browser` | 浏览器控制 | Analyst、WebR |
| `exec` | 系统命令 | Dev、QA、Ops |
| `cron` | 定时任务 | 木木、Ops |
| `image/canvas` | 可视化 | PM、Analyst、Editor |

---

## 5. 即时可执行任务

### 5.1 团队组建（立即执行）
**任务**：定义并激活所有AI角色
**木木行动**：
1. 向老板确认角色定义
2. 创建角色激活模板
3. 准备首次任务分派

### 5.2 技能测试（并行）
**任务**：验证各角色skill可用性
**派遣**：
- Dev: 测试代码编辑能力
- QA: 测试测试框架运行能力
- Ops: 测试部署脚本执行
- Analyst: 测试数据库查询
- Editor: 测试文档撰写
- PM: 测试竞品调研
- HR: 测试角色设计能力

---

## 6. 下一步行动

**老板，请确认/调整**：
1. ✅ 角色定义是否符合预期？
2. 🔧 需要增减哪些角色？
3. 🎯 第一个要执行的任务是什么？

**一旦确认，我立即**：
- 创建角色激活脚本
- 派遣侦察小队验证skill
- 准备第一个实战任务

---

## 7. 报告系统（统一汇总给老板）

### 7.1 报告架构

```
各AI小队执行中 → 实时提交进度报告
                        ↓
木木（报告收集器）→ 聚合 → 去噪 → 结构化
                        ↓
统一报告 → 老板
（每日/每周/任务结束）
```

### 7.2 报告类型

#### A. 实时进度报告（执行中每15分钟）
**来源**：各AI小队自动提交
**格式**：
```
【进度】小队：[角色]-[任务ID]
✅ 完成：[具体成果]
⚠️ 阻塞：[遇到的问题]
📊 进度：[X/Y] 子任务 ([Z%])
⏱️ 预计剩余：[N分钟]
```

#### B. 小队完成报告（任务结束时）
**来源**：AI小队提交 → 木木审核
**格式**：
```
【完成报告】[角色]-[任务ID]
📋 任务：[一句话描述]
✅ 产出：
   1. [文件/成果1]
   2. [文件/成果2]
📊 质量：测试通过/覆盖率/类型检查状态
⚠️ 遗留：[未完成项及原因]
💡 建议：[后续优化建议]
⏱️ 耗时：[X分钟]
```

#### C. 木木汇总报告（统一交给老板）
**频率**：
- **即时**：关键里程碑/阻塞时
- **每日**：17:00提交日报
- **每周**：周日提交周报
- **任务结束**：项目总结报告

**格式**：
```
═══════════════════════════════════════
📊 Signal Hunter AI团队执行报告
日期：2026-01-31 | 报告人：木木（AI项目经理）
═══════════════════════════════════════

【执行概览】
今日活跃小队：X个 | 完成任务：Y个 | 进行中：Z个
整体健康度：🟢 正常 / 🟡 告警 / 🔴 阻塞

【小队汇报】（一句话/小队）
🟢 Dev-[任务A]: 完成数据库重构，测试通过
🟡 QA-[任务B]: 覆盖率提升至75%，还差5%达标
🟢 Editor-[任务C]: README更新完成，已合并
🔴 Ops-[任务D]: 部署脚本遇到权限问题，需人工介入

【关键产出】
1. ✅ [成果1] - [简要说明]
2. ✅ [成果2] - [简要说明]
3. 🔄 [成果3] - [进行中，预计完成时间]

【阻塞与风险】
⚠️ [问题1]：[影响] → [建议行动]
⚠️ [问题2]：[影响] → [建议行动]

【明日计划】
📋 计划派遣：[任务列表]
📋 预计产出：[目标清单]

【需要老板决策】
❓ [决策项1]：[背景] → 选项A/B
❓ [决策项2]：[背景] → 需要确认

═══════════════════════════════════════
详细报告：memory/reports/2026-01-31.md
═══════════════════════════════════════
```

### 7.3 报告存储结构

```
memory/
├── reports/
│   ├── daily/           # 日报
│   │   ├── 2026-01-31.md
│   │   └── ...
│   ├── weekly/          # 周报
│   │   ├── week-04.md
│   │   └── ...
│   ├── projects/        # 项目总结
│   │   ├── anti-echo-v0.3.0.md
│   │   └── ...
│   └── archive/         # 归档
├── squad-reports/       # 小队原始报告
│   ├── dev/
│   ├── qa/
│   └── ...
└── metrics/             # 效能指标
    ├── velocity.json
    └── quality.json
```

### 7.4 报告自动化

**木木自动执行**：
- 每15分钟：收集小队进度，检查超时
- 17:00：生成并发送日报给老板
- 周日：生成周报，总结本周+下周计划
- 任务完成：自动生成项目总结报告

**报告分发**：
- 即时报告：Telegram直接发送
- 日报/周报：同时发送到Telegram + 保存到memory

---

## 8. 下一步行动

**老板，请确认/调整**：
1. ✅ 8个角色定义是否符合预期？（木木/PM/Dev/QA/Ops/Analyst/Editor/HR）
2. ✅ 报告系统格式是否满意？
3. 🎯 第一个要执行的任务是什么？
   - A. 修复代码质量问题（Dev+QA并行）
   - B. 完善项目文档（Editor主责）
   - C. 数据分析报告（Analyst主责）
   - D. 设计新角色（HR主责 - 如UI设计师）
   - E. 其他：______

**一旦确认，我立即**：
1. 派出侦察小队（分析任务）
2. 按角色并行派遣执行小队
3. 建立实时报告收集
4. 向老板提交第一份统一报告
